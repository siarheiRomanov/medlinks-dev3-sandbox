!function(a){"object"==typeof exports&&"undefined"!=typeof module?module.exports=a():"function"==typeof define&&define.amd?define([],a):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Docxtemplater=a()}(function(){return(function(){function a(e,f,c){function d(b,k){if(!f[b]){if(!e[b]){var i="function"==typeof require&&require;if(!k&&i)return i(b,!0);if(g)return g(b,!0);var j=new Error("Cannot find module '"+b+"'");throw j.code="MODULE_NOT_FOUND",j}var h=f[b]={exports:{}};e[b][0].call(h.exports,function(a){return d(e[b][1][a]||a)},h,h.exports,a,e,f,c)}return f[b].exports}for(var g="function"==typeof require&&require,b=0;b<c.length;b++)d(c[b]);return d}return a})()({1:[function(b,a,c){"use strict";a.exports={XMLSerializer:window.XMLSerializer,DOMParser:window.DOMParser,XMLDocument:window.XMLDocument}},{}],2:[function(b,a,c){"use strict";a.exports=function(c,g,k){for(var d={},a=0,h=c.length;a<h;a++){var e=c[a],i=e.getAttribute("ContentType"),j=e.getAttribute("PartName").substr(1);d[j]=i}for(var b=0,f=g.length;b<f;b++)!function(b,c){var a=g[b],e=a.getAttribute("ContentType"),f=a.getAttribute("Extension");k.file(/./).map(function(b){var a=b.name;".xml"!==a.slice(a.length-f.length-1)||d[a]||"[Content_Types].xml"===a||(d[a]=e)})}(b,f);return d}},{}],3:[function(a,e,r){"use strict";function s(c,a){(null==a||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}var b=a("./browser-versions/xmldom.js"),t=b.DOMParser,u=b.XMLSerializer,v=a("./errors").throwXmlTagNotFound,c=a("./utils"),f=c.last,g=c.first;function h(d,c,e){for(var b=e;b>=0;b--)for(var f=d[b],a=0,g=c.length;a<g;a++){var h=c[a];if(y(f.value,h))return a}return null}function i(c,d,e){for(var b=e,f=c.length;b<f;b++)for(var g=c[b],a=0,h=d.length;a<h;a++){var i=d[a];if(x(g.value,i))return a}return -1}function j(c,b){if(0===b.length)return -1;for(var a=0,f=b.length;a<f;a++){var d=b[a],e=b[a+1];if(d.i<c&&(!e||c<e.i)&&"start"===d.part.position)return a}return -1}function k(c,b){if(0===b.length)return -1;for(var a=0,f=b.length;a<f;a++){var d=b[a],e=b[a-1];if(c<d.i&&(!e||e.i<c)&&"end"===d.part.position)return a}return -1}var d=[["&","&amp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&apos;"]];function l(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var m=d.map(function(f){var a,b,c=(b=2,function(a){if(Array.isArray(a))return a}(a=f)||function(d,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(d)){var a=[],b=!0,f=!1,g=void 0;try{for(var h,c=d[Symbol.iterator]();!(b=(h=c.next()).done)&&(a.push(h.value),!e||a.length!==e);b=!0);}catch(i){f=!0,g=i}finally{try{b||null==c.return||c.return()}finally{if(f)throw g}}return a}}(a,b)||function(a,c){if(a){if("string"==typeof a)return s(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if("Object"===b&&a.constructor&&(b=a.constructor.name),"Map"===b||"Set"===b)return Array.from(a);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return s(a,c)}}(a,b)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=c[0],e=c[1];return{rstart:new RegExp(l(e),"g"),rend:new RegExp(l(d),"g"),start:e,end:d}}),w=new RegExp("\xa0","g");function x(a,b){return a==="</"+b+">"}function y(a,b){return 0===a.indexOf("<"+b)&& -1!==[">"," "].indexOf(a[b.length+1])}function n(e,a,h){"string"==typeof a&&(a=[a]);for(var c=1,b=h,i=e.length;b<i;b++)for(var f=e[b],d=0,j=a.length;d<j;d++){var g=a[d];if(x(f.value,g)&&c--,y(f.value,g)&&c++,0===c)return b}return null}function o(g,a,h){"string"==typeof a&&(a=[a]);for(var c=1,b=h;b>=0;b--)for(var e=g[b],d=0,i=a.length;d<i;d++){var f=a[d];if(y(e.value,f)&&c--,x(e.value,f)&&c++,0===c)return b}return null}function p(b,a){var c=a.type,d=a.tag,e=a.position;return"tag"===c&&d===b&&"start"===e}function q(b,a){var c=a.type,d=a.tag,e=a.position;return"tag"===c&&d===b&&"end"===e}var z=/[\x00-\x08\x0B\x0C\x0E-\x1F]/;e.exports={endsWith:function(a,b){return -1!==a.indexOf(b,a.length-b.length)},startsWith:function(b,a){return b.substring(0,a.length)===a},getNearestLeft:function(c,a,d){var b=h(c,a,d);return -1!==b?a[b]:null},getNearestRight:function(c,a,d){var b=i(c,a,d);return -1!==b?a[b]:null},getNearestLeftWithCache:function(c,a){var b=j(c,a);return -1!==b?a[b].part.tag:null},getNearestRightWithCache:function(c,a){var b=k(c,a);return -1!==b?a[b].part.tag:null},getNearestLeftIndex:h,getNearestRightIndex:i,getNearestLeftIndexWithCache:j,getNearestRightIndexWithCache:k,buildNearestCache:function(a,b){return a.reduce(function(c,a,d){return"tag"===a.type&& -1!==b.indexOf(a.tag)&&c.push({i:d,part:a}),c},[])},isContent:function(a){return"placeholder"===a.type||"content"===a.type&&"insidetag"===a.position},isParagraphStart:function(a){return p("w:p",a)||p("a:p",a)},isParagraphEnd:function(a){return q("w:p",a)||q("a:p",a)},isTagStart:p,isTagEnd:q,isTextStart:function(a){return"tag"===a.type&&"start"===a.position&&a.text},isTextEnd:function(a){return"tag"===a.type&&"end"===a.position&&a.text},unique:function(b){for(var c={},d=[],a=0,e=b.length;a<e;++a)c.hasOwnProperty(b[a])||(c[b[a]]=!0,d.push(b[a]));return d},chunkBy:function(a,b){return a.reduce(function(a,c){var d=f(a),e=b(c);return 0===d.length?(d.push(c),a):("start"===e?a.push([c]):"end"===e?(d.push(c),a.push([])):d.push(c),a)},[[]]).filter(function(a){return a.length>0})},last:f,first:g,mergeObjects:function(){for(var c,a,e={},d=0;d<arguments.length;d+=1){c=arguments[d],a=Object.keys(c);for(var b=0;b<a.length;b+=1)e[a[b]]=c[a[b]]}return e},xml2str:function(a){return new u().serializeToString(a).replace(/xmlns(:[a-z0-9]+)?="" ?/g,"")},str2xml:function(a){return 65279===a.charCodeAt(0)&&(a=a.substr(1)),new t().parseFromString(a,"text/xml")},getRightOrNull:n,getRight:function(a,b,c){var d=n(a,b,c);if(null!==d)return d;v({position:"right",element:b,parsed:a,index:c})},getLeftOrNull:o,getLeft:function(a,b,c){var d=o(a,b,c);if(null!==d)return d;v({position:"left",element:b,parsed:a,index:c})},pregMatchAll:function(c,d){for(var a,b=[];null!=(a=c.exec(d));)b.push({array:a,offset:a.index});return b},convertSpaces:function(a){return a.replace(w," ")},escapeRegExp:l,charMapRegexes:m,hasCorruptCharacters:function(a){return z.test(a)},defaults:{paragraphLoop:!1,nullGetter:function(a){return a.module?(a.module,""):"undefined"},xmlFileNames:[],parser:function(a){return{get:function(b){return"."===a?b:b[a]}}},linebreaks:!1,fileTypeConfig:null,delimiters:{start:"{",end:"}"}},wordToUtf8:function(a){for(var b,c=m.length-1;c>=0;c--)b=m[c],a=a.replace(b.rstart,b.end);return a},utf8ToWord:function(a){"string"!=typeof a&&(a=a.toString());for(var b,c=0,d=m.length;c<d;c++)b=m[c],a=a.replace(b.rend,b.start);return a},concatArrays:function(c){for(var d=[],a=0;a<c.length;a++)for(var e=c[a],b=0,f=e.length;b<f;b++)d.push(e[b]);return d},invertMap:function(a){return Object.keys(a).reduce(function(b,d){var c=a[d];return b[c]=b[c]||[],b[c].push(d),b},{})},charMap:d}},{"./browser-versions/xmldom.js":1,"./errors":4,"./utils":24}],4:[function(h,i,j){"use strict";function k(c,d){var a=Object.keys(c);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(c);d&&(b=b.filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable})),a.push.apply(a,b)}return a}function l(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var c=h("./utils"),m=c.last,n=c.first;function a(a){this.name="GenericError",this.message=a,this.stack=new Error(a).stack}function d(a){this.name="TemplateError",this.message=a,this.stack=new Error(a).stack}function b(a){this.name="RenderingError",this.message=a,this.stack=new Error(a).stack}function e(a){this.name="ScopeParserError",this.message=a,this.stack=new Error(a).stack}function f(a){this.name="InternalError",this.properties={explanation:"InternalError"},this.message=a,this.stack=new Error(a).stack}function g(a){this.name="APIVersionError",this.properties={explanation:"APIVersionError"},this.message=a,this.stack=new Error(a).stack}a.prototype=Error.prototype,d.prototype=new a,b.prototype=new a,e.prototype=new a,f.prototype=new a,g.prototype=new a,i.exports={XTError:a,XTTemplateError:d,XTInternalError:f,XTScopeParserError:e,XTAPIVersionError:g,RenderingError:b,XTRenderingError:b,getClosingTagNotMatchOpeningTag:function(c){var a=c.tags,b=new d("Closing tag does not match opening tag");return b.properties={id:"closing_tag_does_not_match_opening_tag",explanation:'The tag "'.concat(a[0].value,'" is closed by the tag "').concat(a[1].value,'"'),openingtag:n(a).value,offset:[n(a).offset,m(a).offset],closingtag:m(a).value},b},getLoopPositionProducesInvalidXMLError:function(b){var a=b.tag,e=b.offset,c=new d('The position of the loop tags "'.concat(a,'" would produce invalid XML'));return c.properties={tag:a,id:"loop_position_invalid",explanation:'The tags "'.concat(a,'" are misplaced in the document, for example one of them is in a table and the other one outside the table'),offset:e},c},getScopeCompilationError:function(a){var b=a.tag,d=a.rootError,f=a.offset,c=new e("Scope parser compilation failed");return c.properties={id:"scopeparser_compilation_failed",offset:f,tag:b,explanation:'The scope parser for the tag "'.concat(b,'" failed to compile'),rootError:d},c},getScopeParserExecutionError:function(a){var b=a.tag,d=a.scope,f=a.error,g=a.offset,c=new e("Scope parser execution failed");return c.properties={id:"scopeparser_execution_failed",explanation:"The scope parser for the tag ".concat(b," failed to execute"),scope:d,offset:g,tag:b,rootError:f},c},getUnclosedTagException:function(a){var b=new d("Unclosed tag");return b.properties={xtag:n(a.xtag.split(" ")).substr(1),id:"unclosed_tag",context:a.xtag,offset:a.offset,lIndex:a.lIndex,explanation:'The tag beginning with "'.concat(a.xtag.substr(0,10),'" is unclosed')},b},getUnopenedTagException:function(a){var b=new d("Unopened tag");return b.properties={xtag:m(a.xtag.split(" ")),id:"unopened_tag",context:a.xtag,offset:a.offset,lIndex:a.lIndex,explanation:'The tag beginning with "'.concat(a.xtag.substr(0,10),'" is unopened')},b},getUnmatchedLoopException:function(a){var b=a.location,g=a.offset,c="start"===b?"unclosed":"unopened",e=new d("".concat("start"===b?"Unclosed":"Unopened"," loop")),f=a.value;return e.properties={id:"".concat(c,"_loop"),explanation:'The loop with tag "'.concat(f,'" is ').concat(c),xtag:f,offset:g},e},getDuplicateCloseTagException:function(a){var b=new d("Duplicate close tag, expected one close tag");return b.properties={xtag:n(a.xtag.split(" ")),id:"duplicate_close_tag",context:a.xtag,offset:a.offset,lIndex:a.lIndex,explanation:'The tag ending with "'.concat(a.xtag.substr(0,10),'" has duplicate close tags')},b},getDuplicateOpenTagException:function(a){var b=new d("Duplicate open tag, expected one open tag");return b.properties={xtag:n(a.xtag.split(" ")),id:"duplicate_open_tag",context:a.xtag,offset:a.offset,lIndex:a.lIndex,explanation:'The tag beginning with "'.concat(a.xtag.substr(0,10),'" has duplicate open tags')},b},getCorruptCharactersException:function(a){var d=a.tag,e=a.value,f=a.offset,c=new b("There are some XML corrupt characters");return c.properties={id:"invalid_xml_characters",xtag:d,value:e,offset:f,explanation:"There are some corrupt characters for the field ${tag}"},c},getUnbalancedLoopException:function(a,b){var c=new d("Unbalanced loop tag"),e=b[0].part.value,f=b[1].part.value,g=a[0].part.value,h=a[1].part.value;return c.properties={id:"unbalanced_loop_tags",explanation:"Unbalanced loop tags {#".concat(e,"}{/").concat(f,"}{#").concat(g,"}{/").concat(h,"}"),offset:[b[0].part.offset,a[1].part.offset],lastPair:{left:b[0].part.value,right:b[1].part.value},pair:{left:a[0].part.value,right:a[1].part.value}},c},throwApiVersionError:function(b,c){var a=new g(b);throw a.properties=function(c){for(var a=1;a<arguments.length;a++){var b=null!=arguments[a]?arguments[a]:{};a%2?k(Object(b),!0).forEach(function(a){l(c,a,b[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(b)):k(Object(b)).forEach(function(a){Object.defineProperty(c,a,Object.getOwnPropertyDescriptor(b,a))})}return c}({id:"api_version_error"},c),a},throwContentMustBeString:function(b){var a=new f("Content must be a string");throw a.properties.id="xmltemplater_content_must_be_string",a.properties.type=b,a},throwFileTypeNotHandled:function(a){var b=new f('The filetype "'.concat(a,'" is not handled by docxtemplater'));throw b.properties={id:"filetype_not_handled",explanation:'The file you are trying to generate is of type "'.concat(a,'", but only docx and pptx formats are handled'),fileType:a},b},throwFileTypeNotIdentified:function(){var a=new f("The filetype for this file could not be identified, is this file corrupted ?");throw a.properties={id:"filetype_not_identified"},a},throwLocationInvalid:function(a){throw new f('Location should be one of "start" or "end" (given : '.concat(a.location,")"))},throwMalformedXml:function(b){var a=new f("Malformed xml");throw a.properties={part:b,id:"malformed_xml"},a},throwMultiError:function(b){var a=new d("Multi error");throw a.properties={errors:b,id:"multi_error",explanation:"The template has multiple errors"},a},throwExpandNotFound:function(a){var c=a.part,e=c.value,j=c.offset,f=a.id,g=a.message,k=a.part,h=a.explanation,b=void 0===h?'The tag "'.concat(e,'" is not inside a paragraph'):h;"function"==typeof b&&(b=b(k));var i=new d(void 0===g?"Raw tag not in paragraph":g);throw i.properties={id:void 0===f?"raw_tag_outerxml_invalid":f,explanation:b,rootError:a.rootError,xtag:e,offset:j,postparsed:a.postparsed,expandTo:a.expandTo,index:a.index},i},throwRawTagShouldBeOnlyTextInParagraph:function(a){var b=new d("Raw tag should be the only text in paragraph"),c=a.part.value;throw b.properties={id:"raw_xml_tag_should_be_only_text_in_paragraph",explanation:'The raw tag "'.concat(c,'" should be the only text in this paragraph. This means that this tag should not be surrounded by any text or spaces.'),xtag:c,offset:a.part.offset,paragraphParts:a.paragraphParts},b},throwUnimplementedTagType:function(a,e){var b='Unimplemented tag type "'.concat(a.type,'"');a.module&&(b+=' "'.concat(a.module,'"'));var c=new d(b);throw c.properties={part:a,index:e,id:"unimplemented_tag_type"},c},throwXmlTagNotFound:function(a){var b=new d('No tag "'.concat(a.element,'" was found at the ').concat(a.position)),c=a.parsed[a.index];throw b.properties={id:"no_xml_tag_found_at_".concat(a.position),explanation:'No tag "'.concat(a.element,'" was found at the ').concat(a.position),offset:c.offset,part:c,parsed:a.parsed,index:a.index,element:a.element},b},throwXmlInvalid:function(b,c){var a=new d("An XML file has invalid xml");throw a.properties={id:"file_has_invalid_xml",content:b,offset:c,explanation:"The docx contains invalid XML, it is most likely corrupt"},a},throwResolveBeforeCompile:function(){var a=new f("You must run `.compile()` before running `.resolveData()`");throw a.properties={id:"resolve_before_compile"},a},throwRenderInvalidTemplate:function(){var a=new f("You should not call .render on a document that had compilation errors");throw a.properties={id:"render_on_invalid_template"},a}}},{"./utils":24}],5:[function(a,b,c){"use strict";var d=a("./modules/loop"),e=a("./modules/space-preserve"),f=a("./modules/rawxml"),g=a("./modules/expand-pair-trait"),h=a("./modules/render");b.exports={docx:function(){return{getTemplatedFiles:function(a){return a.file(/word\/(header|footer)\d+\.xml/).map(function(a){return a.name}).concat(["docProps/core.xml","docProps/app.xml","word/settings.xml"])},textPath:function(a){return a.targets[0]},tagsXmlTextArray:["Company","HyperlinkBase","Manager","cp:category","cp:keywords","dc:creator","dc:description","dc:subject","dc:title","w:t","m:t","vt:lpstr"],tagsXmlLexedArray:["w:proofState","w:tc","w:tr","w:table","w:p","w:r","w:br","w:rPr","w:pPr","w:spacing","w:sdtContent","w:sectPr","w:headerReference","w:footerReference"],expandTags:[{contains:"w:tc",expand:"w:tr"}],onParagraphLoop:[{contains:"w:p",expand:"w:p",onlyTextInTag:!0}],tagRawXml:"w:p",tagTextXml:"w:t",baseModules:[d,e,g,f,h],tagShouldContain:[{tag:"w:tc",shouldContain:["w:p"],value:"<w:p></w:p>"},{tag:"w:sdtContent",shouldContain:["w:p","w:r"],value:"<w:p></w:p>"}]}},pptx:function(){return{getTemplatedFiles:function(a){return a.file(/ppt\/(slideMasters)\/(slideMaster)\d+\.xml/).map(function(a){return a.name}).concat(["ppt/presentation.xml","docProps/app.xml","docProps/core.xml"])},textPath:function(){return"ppt/slides/slide1.xml"},tagsXmlTextArray:["Company","HyperlinkBase","Manager","cp:category","cp:keywords","dc:creator","dc:description","dc:subject","dc:title","a:t","m:t","vt:lpstr"],tagsXmlLexedArray:["p:sp","a:tc","a:tr","a:table","a:p","a:r","a:rPr","p:txBody","a:txBody"],expandTags:[{contains:"a:tc",expand:"a:tr"}],onParagraphLoop:[{contains:"a:p",expand:"a:p",onlyTextInTag:!0}],tagRawXml:"p:sp",tagTextXml:"a:t",baseModules:[d,g,f,h],tagShouldContain:[{tag:"p:txBody",shouldContain:["a:p"],value:"<a:p></a:p>"},{tag:"a:txBody",shouldContain:["a:p"],value:"<a:p></a:p>"}]}}}},{"./modules/expand-pair-trait":12,"./modules/loop":13,"./modules/rawxml":14,"./modules/render":15,"./modules/space-preserve":16}],6:[function(b,a,c){"use strict";a.exports={docx:["application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","application/vnd.ms-word.document.macroEnabled.main+xml","application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml","application/vnd.ms-word.template.macroEnabledTemplate.main+xml"],pptx:["application/vnd.openxmlformats-officedocument.presentationml.slide+xml"]}},{}],7:[function(a,c,d){"use strict";var b=a("./doc-utils"),e=b.endsWith,f=b.startsWith,g=a("./filetypes");c.exports=function(a,b){var c=b.fileTypeConfig.tagShouldContain||[],d="",h=-1;return b.basePart|| -1===g.docx.indexOf(b.contentType)||(a=function(a){for(var c=!1,b=a.length-1;b>=0;b--){var d=a[b];if(f(d,"<w:sectPr")&&(c=!0),c){var g=d.trim();if(e(g,"</w:tbl>"))return a.splice(b+1,0,"<w:p><w:r><w:t></w:t></w:r></w:p>"),a;if(e(g,"</w:p>"))break}}return a}(a)),a.reduce(function(b,a){for(var e=0,l=c.length;e<l;e++){var f=c[e],i=f.tag,j=f.shouldContain,m=f.value,n=new RegExp("^(<(".concat(i,")[^>]*>)$"),"g");if(h===e){if(a==="</".concat(i,">"))return h=-1,b+d+m+a;d+=a;for(var g=0,o=j.length;g<o;g++){var k=j[g];if(-1!==a.indexOf("<".concat(k," "))|| -1!==a.indexOf("<".concat(k,">")))return h=-1,b+d}return b}if(-1===h&&n.test(a)){if("/"===a[a.length-2])return b;return h=e,d=a,b}}return b+a},"")}},{"./doc-utils":3,"./filetypes":6}],8:[function(c,d,f){"use strict";function g(a,b){return l(a)||k(a,b)||i(a,b)||h()}function h(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(a,c){if(a){if("string"==typeof a)return j(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if("Object"===b&&a.constructor&&(b=a.constructor.name),"Map"===b||"Set"===b)return Array.from(a);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return j(a,c)}}function j(c,a){(null==a||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function k(d,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(d)){var a=[],b=!0,f=!1,g=void 0;try{for(var h,c=d[Symbol.iterator]();!(b=(h=c.next()).done)&&(a.push(h.value),!e||a.length!==e);b=!0);}catch(i){f=!0,g=i}finally{try{b||null==c.return||c.return()}finally{if(f)throw g}}return a}}function l(a){if(Array.isArray(a))return a}var a=c("./errors"),m=a.getUnclosedTagException,n=a.getUnopenedTagException,o=a.getDuplicateOpenTagException,p=a.getDuplicateCloseTagException,q=a.throwMalformedXml,r=a.throwXmlInvalid,b=c("./doc-utils"),s=b.concatArrays,t=b.isTextStart,u=b.isTextEnd;function v(a,b){return a[0]<=b.offset&&b.offset<a[1]}function w(a,b){return t(a)?(b&&q(a),!0):u(a)?(b||q(a),!1):b}function x(a){var c="",d=1,b=a.indexOf(" ");return"/"===a[a.length-2]?(c="selfclosing",-1===b&&(b=a.length-2)):"/"===a[1]?(d=2,c="end",-1===b&&(b=a.length-1)):(c="start",-1===b&&(b=a.length-1)),{tag:a.slice(d,b),position:c}}function y(a,b){return -1===a&& -1===b?-2:a===b?0:-1===a|| -1===b?b<a?-1:1:a<b?-1:1}function z(e){var a=e.split(" ");if(2!==a.length)throw new Error("New Delimiters cannot be parsed");var b=g(a,2),c=b[0],d=b[1];if(0===c.length||0===d.length)throw new Error("New Delimiters cannot be parsed");return[c,d]}function e(a,d){var b=a.map(function(a){return a.value}).join(""),e=function(c,l){for(var f=[],b=l.start,d=l.end,a=-1,i=!1;;){var j=c.indexOf(b,a+1),m=c.indexOf(d,a+1),h=null,k=void 0,e=y(j,m);if(-2===e)return f;if(0===e&&(e=i?1:-1),1===e&&(i=!1,a=m,h="end",k=d.length),-1===e&&(i=!0,a=j,h="start",k=b.length),"start"===h&&"="===c[a+b.length]){f.push({offset:j,position:"start",length:b.length,changedelimiter:!0});var n=c.indexOf("=",a+b.length+1),o=c.indexOf(d,n+1);f.push({offset:o,position:"end",length:d.length,changedelimiter:!0});var q=z(c.substr(a+b.length+1,n-a-b.length-1)),p=g(q,2);b=p[0],d=p[1],a=o;continue}f.push({offset:a,position:h,length:k})}}(b,d),h=0,c=a.map(function(a){return{offset:(h+=a.value.length)-a.value.length,lIndex:a.lIndex}}),f=function(b,c,h){if(0===b.length)return[];var d,e=[],g=!1,a={offset:0},i=0;b.forEach(function(b){for(;h[i+1]&&!(h[i+1].offset>b.offset);)i++;d=c.substr(a.offset,b.offset-a.offset),"start"===b.position&&g||"end"===b.position&&!g?"start"===b.position?(a.offset+a.length===b.offset?(d=c.substr(a.offset,b.offset-a.offset+a.length+4),e.push(o({xtag:d,offset:a.offset}))):e.push(m({xtag:d,offset:a.offset})),b.error=!0):(a.offset+a.length===b.offset?(d=c.substr(a.offset-4,b.offset-a.offset+4+a.length),e.push(p({xtag:d,offset:a.offset}))):e.push(n({xtag:d,offset:b.offset})),b.error=!0):g=!g,a=b});var f={offset:c.length};return d=c.substr(a.offset,f.offset-a.offset),g&&(e.push(m({xtag:d,offset:a.offset})),f.error=!0),e}(e,b,c),i=0,j=0;return{parsed:c.map(function(l,d){for(var n,b=l.offset,m=[b,b+a[d].value.length],f=a[d].value,g=[];j<e.length&&v(m,e[j]);)g.push(e[j]),j++;var h=[],c=0;i>0&&(c=i,i=0),g.forEach(function(a){var d=f.substr(c,a.offset-b-c);if(d.length>0){if(n){a.changedelimiter&&(c=a.offset-b+a.length,n="start"===a.position);return}h.push({type:"content",value:d,offset:c+b}),c+=d.length}var e={type:"delimiter",position:a.position,offset:c+b};if(a.error&&(e.error=a.error),a.changedelimiter){n="start"===a.position,c=a.offset-b+a.length;return}h.push(e),c=a.offset-b+a.length}),i=c-f.length;var k=f.substr(c);return k.length>0&&h.push({type:"content",value:k,offset:b}),h},this),errors:f}}d.exports={parseDelimiters:e,parse:function(a,f){var i,g,b,j=!1,c=e((g=!1,b=[],a.forEach(function(a){(g=w(a,g))&&"content"===a.type&&b.push(a)}),b),f),k=c.parsed,h=c.errors,d=[],l=0;return a.forEach(function(a){j=w(a,j),"content"===a.type&&(a.position=j?"insidetag":"outsidetag"),j&&"content"===a.type?(Array.prototype.push.apply(d,k[l].map(function(a){return"content"===a.type&&(a.position="insidetag"),a})),l++):d.push(a)}),{errors:h,lexed:d=d.map(function(a,b){return a.lIndex=b,a})}},xmlparse:function(a,b){var e=function(b,j,k){for(var a=0,l=b.length,m=s([j.map(function(a){return{tag:a,text:!0}}),k.map(function(a){return{tag:a,text:!1}})]).reduce(function(a,b){return a[b.tag]=b.text,a},{}),d=[];a<l&& -1!==(a=b.indexOf("<",a));){var c=a,e=b.indexOf("<",a+1);(-1===(a=b.indexOf(">",a))|| -1!==e&&a>e)&&r(b,c);var f=b.slice(c,a+1),g=x(f),h=g.tag,n=g.position,i=m[h];null!=i&&d.push({type:"tag",position:n,text:i,offset:c,value:f,tag:h})}return d}(a,b.text,b.other),f=0,c=e.reduce(function(c,b){var d=a.substr(f,b.offset-f);return d.length>0&&c.push({type:"content",value:d}),f=b.offset+b.value.length,delete b.offset,b.value.length>0&&c.push(b),c},[]),d=a.substr(f);return d.length>0&&c.push({type:"content",value:d}),c}}},{"./doc-utils":3,"./errors":4}],9:[function(b,a,c){"use strict";function d(c,d){for(var b=-1,a=0,e=c.length;a<e;a++)!(d[a]>=c[a].length)&&(-1===b||c[a][d[a]].offset<c[b][d[b]].offset)&&(b=a);if(-1===b)throw new Error("minIndex negative");return b}a.exports=function(a){var f=a.reduce(function(a,b){return a+b.length},0);a=a.filter(function(a){return a.length>0});for(var g=new Array(f),b=a.map(function(){return 0}),c=0;c<=f-1;){var e=d(a,b);g[c]=a[e][b[e]],b[e]++,c++}return g}},{}],10:[function(b,a,c){"use strict";function d(){}function e(a){return a}a.exports=function(b){var a={set:d,parse:d,render:d,getTraits:d,getFileType:d,nullGetter:d,optionsTransformer:e,postrender:e,errorsTransformer:e,getRenderedMap:e,preparse:e,postparse:e,on:d,resolve:d};if(Object.keys(a).every(function(a){return!b[a]}))throw new Error("This module cannot be wrapped, because it doesn't define any of the necessary functions");return Object.keys(a).forEach(function(c){b[c]=b[c]||a[c]}),b}},{}],11:[function(a,b,c){"use strict";function d(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}var e=a("../module-wrapper"),f=a("../doc-utils").concatArrays,g=a("../filetypes"),h=function(){var a,b,c;function e(){!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="Common"}return a=e,b=[{key:"set",value:function(b){var a=b.invertedContentTypes;a&&(this.invertedContentTypes=a)}},{key:"getFileType",value:function(k){var c=k.doc,d=this.invertedContentTypes;if(this.invertedContentTypes)for(var e=Object.keys(g),a=0,l=e.length;a<l;a++)for(var h=e[a],i=g[h],b=0,m=i.length;b<m;b++){var j=i[b];if(d[j])return c.targets=f([c.targets,d[j]]),h}}}],d(a.prototype,b),c&&d(a,c),e}();b.exports=function(){return e(new h)}},{"../doc-utils":3,"../filetypes":6,"../module-wrapper":10}],12:[function(a,d,e){"use strict";var f="expandPair",g=a("../mergesort"),c=a("../doc-utils"),h=c.getLeft,i=c.getRight,j=a("../module-wrapper"),k=a("../traits").getExpandToDefault,b=a("../errors"),l=b.getUnmatchedLoopException,m=b.getClosingTagNotMatchOpeningTag,n=b.throwLocationInvalid,o=b.getUnbalancedLoopException;function p(a){switch(a.location){case"start":return 1;case"end":return -1;default:n(a)}}function q(b,a){return null!=b&&null!=a&&("start"===b.part.location&&"end"===a.part.location&&b.part.value===a.part.value||""===a.part.value)}function r(a){for(var e=0,b=[];e<a.length;){var g=a[e].part;if("end"===g.location){if(0===e)return a.splice(0,1),b.push(l(g)),{traits:a,errors:b};var c=e,d=e-1,f=1;if(q(a[d],a[c]))return a.splice(c,1),a.splice(d,1),{errors:b,traits:a};for(;f<50;){var h=a[d-f],i=a[c+f];if(q(h,a[c]))return a.splice(c,1),a.splice(d-f,1),{errors:b,traits:a};if(q(a[d],i))return a.splice(c+f,1),a.splice(d,1),{errors:b,traits:a};f++}return b.push(m({tags:[a[d].part,a[c].part]})),a.splice(c,1),a.splice(d,1),{traits:a,errors:b}}if(null==a[e])break;e++}return a.forEach(function(a){var c=a.part;b.push(l(c))}),{traits:[],errors:b}}var s={name:"ExpandPairTrait",optionsTransformer:function(b,a){return this.expandTags=a.fileTypeConfig.expandTags.concat(a.options.paragraphLoop?a.fileTypeConfig.onParagraphLoop:[]),b},postparse:function(b,d){var m,n=this,j=d.getTraits,q=d.postparse,a=j(f,b);a=g(a=a.map(function(a){return a||[]}));var e=function(c){for(var i={},b=[],d=[],a=0,e=[],f=0;f<c.length;f++){var j=c[f],o=j.part,k=p(j.part);a+=k;var l=void 0;l=1===k?a-1:a,e.push({level:l,part:o})}for(;e.length>0;){var m=r(e);b=b.concat(m.errors),e=m.traits}if(b.length>0)return{pairs:d,errors:b};a=0;for(var g=0;g<c.length;g++){var h=c[g],n=p(h.part);if(a+=n,1===n)i[a]=h;else{var q=i[a+1];0===a&&(d=d.concat([[q,h]]))}a=a>=0?a:0}return{pairs:d,errors:b}}(a),l=e.pairs,c=e.errors,s=0,t=null,u=l.map(function(a){var e,f,d=a[0].part.expandTo;if("auto"===d){var g=k(b,a,n.expandTags);g.error&&c.push(g.error),d=g.value}if(!d){var j=a[0].offset,l=a[1].offset;return j<s&&c.push(o(a,t)),t=a,s=l,[j,l]}try{e=h(b,d,a[0].offset)}catch(m){c.push(m)}try{f=i(b,d,a[1].offset)}catch(p){c.push(p)}return e<s&&c.push(o(a,t)),s=f,t=a,[e,f]});if(c.length>0)return{postparsed:b,errors:c};var v=0;return{postparsed:b.reduce(function(d,f,a){var h=v<l.length&&u[v][0]<=a&&a<=u[v][1],e=l[v],g=u[v];if(!h)return d.push(f),d;if(g[0]===a&&(m=[]),e[0].offset!==a&&e[1].offset!==a&&m.push(f),g[1]===a){var c=b[e[0].offset];c.subparsed=q(m,{basePart:c}),delete c.location,delete c.expandTo,d.push(c),v++}return d},[]),errors:c}}};d.exports=function(){return j(s)}},{"../doc-utils":3,"../errors":4,"../mergesort":9,"../module-wrapper":10,"../traits":23}],13:[function(b,c,d){"use strict";function e(c,d){var a=Object.keys(c);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(c);d&&(b=b.filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable})),a.push.apply(a,b)}return a}function f(c){for(var a=1;a<arguments.length;a++){var b=null!=arguments[a]?arguments[a]:{};a%2?e(Object(b),!0).forEach(function(a){g(c,a,b[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(b)):e(Object(b)).forEach(function(a){Object.defineProperty(c,a,Object.getOwnPropertyDescriptor(b,a))})}return c}function g(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function h(a,c){if(a){if("string"==typeof a)return i(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if("Object"===b&&a.constructor&&(b=a.constructor.name),"Map"===b||"Set"===b)return Array.from(a);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return i(a,c)}}function i(c,a){(null==a||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function j(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}var a=b("../doc-utils"),k=a.mergeObjects,l=a.chunkBy,m=a.last,n=a.isParagraphStart,o=a.isParagraphEnd,p=a.isContent,q=a.startsWith,r=b("../module-wrapper"),s="loop";function t(b){var a=function(b){for(var a=0,c=b.length;a<c;a++)if("content"!==b[a].type)return b[a];return null}(b.subparsed);return null!=a&&"w:t"!==a.tag}function u(a){var b;return a.some(function(a){return p(a)})?0:a.length}function v(a){return a.some(function(a){if("w:br"===a.tag&& -1!==a.value.indexOf('w:type="page"'))return!0})}var w=function(){var a,b,c;function d(){!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,d),this.name="LoopModule",this.totalSectPr=0,this.prefix={start:"#",end:"/",dash:/^-([^\s]+)\s(.+)$/,inverted:"^"}}return a=d,b=[{key:"parse",value:function(a,g){var b=g.match,i=g.getValue,p=g.getValues,c=s,d="placeholder",e=this.prefix,k=e.start,l=e.inverted,m=e.dash,n=e.end;if(b(k,a))return{type:d,value:i(k,a),expandTo:"auto",module:c,location:"start",inverted:!1};if(b(l,a))return{type:d,value:i(l,a),expandTo:"auto",module:c,location:"start",inverted:!0};if(b(n,a))return{type:d,value:i(n,a),module:c,location:"end"};if(b(m,a)){var f,j,o=(f=p(m,a),j=3,function(a){if(Array.isArray(a))return a}(f)||function(d,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(d)){var a=[],b=!0,f=!1,g=void 0;try{for(var h,c=d[Symbol.iterator]();!(b=(h=c.next()).done)&&(a.push(h.value),!e||a.length!==e);b=!0);}catch(i){f=!0,g=i}finally{try{b||null==c.return||c.return()}finally{if(f)throw g}}return a}}(f,j)||h(f,j)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),q=o[1],r=o[2];return{type:d,value:r,expandTo:q,module:c,location:"start",inverted:!1}}return null}},{key:"getTraits",value:function(a,b){if("expandPair"===a)return b.reduce(function(b,a,c){return"placeholder"===a.type&&a.module===s&&null==a.subparsed&&b.push({part:a,offset:c}),b},[])}},{key:"postparse",value:function(b,j){var p,k,e,c,a=j.basePart;if(a&&(a.sectPrCount=(k=!1,e=0,b.forEach(function(a){"w:sectPr"===a.tag&&"start"===a.position&&(k=!0),k&&("w:headerReference"===a.tag||"w:footerReference"===a.tag)&&(e++,k=!1),"w:sectPr"===a.tag&&"end"===a.position&&(k=!1)}),e),a.sectPrIndex=this.totalSectPr,this.totalSectPr+=a.sectPrCount),!a||"auto"!==a.expandTo||a.module!==s||!(0!==(c=b).length&&n(c[0])&&o(m(c))))return b;var q=0,d=l(b,function(a){return n(a)&&1== ++q?"start":o(a)&&0== --q?"end":null});if(d.length<=2)return b;var f=d[0],g=m(d),h=u(f),i=u(g);return(a.hasPageBreak=v(g),a.hasPageBreakBeginning=v(f),0===h||0===i)?b:b.slice(h,b.length-i)}},{key:"render",value:function(a,c){if("placeholder"!==a.type||a.module!==s)return null;var d,e,g=[],b=[];try{e=c.scopeManager.loopOver(a.value,function(j,e,f){var n,h,l,m,i=c.scopeManager.createSubScopeManager(j,a.value,e,a,f),d=c.render(k({},c,{compiled:a.subparsed,tags:{},scopeManager:i}));a.hasPageBreak&&e===f-1&&t(a)&&function(a){for(var b=!1,c=a.parts.length-1,d=a.parts.length-1;c>=0;c--)if("</w:p>"===a.parts[d]&&!b){b=!0,a.parts.splice(d,0,'<w:r><w:br w:type="page"/></w:r>');break}b||a.parts.push('<w:p><w:r><w:br w:type="page"/></w:r></w:p>')}(d),i.scopePathItem.some(function(a){return 0!==a})&&(1===a.sectPrCount&&(d.parts=(0,d.parts).filter(function(a){return!(q(a,"<w:headerReference")||q(a,"<w:footerReference"))})),0===a.sectPrIndex&&(d.parts=(h=d.parts,l=!1,m=!1,h.reduce(function(b,a){return!1===l&&q(a,"<w:sectPr")&&(m=!0),m&&(q(a,"<w:type")&&(l=!0),!1===l&&q(a,"</w:sectPr")&&b.push('<w:type w:val="continuous"/>')),b.push(a),b},[])))),a.hasPageBreakBeginning&&t(a)&&function(a){a.parts.unshift('<w:p><w:r><w:br w:type="page"/></w:r></w:p>')}(d),g=g.concat(d.parts),b=b.concat(d.errors||[])},a.inverted,{part:a})}catch(h){return b.push(h),{errors:b}}return!1===e?{value:((d=a).hasPageBreak&&t(d)?'<w:p><w:r><w:br w:type="page"/></w:r></w:p>':"")||"",errors:b}:{value:c.joinUncorrupt(g,f(f({},c),{},{basePart:a})),errors:b}}},{key:"resolve",value:function(a,b){if("placeholder"!==a.type||a.module!==s)return null;var c=b.scopeManager,d=c.getValueAsync(a.value,{part:a}),e=[];function f(d,f,g){var h=c.createSubScopeManager(d,a.value,f,a,g);e.push(b.resolve({filePath:b.filePath,modules:b.modules,baseNullGetter:b.baseNullGetter,resolve:b.resolve,compiled:a.subparsed,tags:{},scopeManager:h}))}var g=[];return d.then(function(b){return c.loopOverValue(b,f,a.inverted),Promise.all(e).then(function(a){return a.map(function(b){var a,d=b.resolved,c=b.errors;return c.length>0&&g.push.apply(g,function(a){if(Array.isArray(a))return i(a)}(a=c)||function(a){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a))return Array.from(a)}(a)||h(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d})}).then(function(a){if(g.length>0)throw g;return a})})}}],j(a.prototype,b),c&&j(a,c),d}();c.exports=function(){return r(new w)}},{"../doc-utils":3,"../module-wrapper":10}],14:[function(a,b,c){"use strict";function d(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}var e=a("../traits"),f=a("../doc-utils").isContent,g=a("../errors").throwRawTagShouldBeOnlyTextInParagraph,h="rawxml",i=a("../module-wrapper");function j(a){var b=a.part,c=a.left,d=a.right,e=a.postparsed,i=a.index,h=e.slice(c+1,d);return h.forEach(function(a,d){d!==i-c-1&&f(a)&&g({paragraphParts:h,part:b})}),b}var k=function(){var a,b,c;function f(){!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,f),this.name="RawXmlModule",this.prefix="@"}return a=f,b=[{key:"optionsTransformer",value:function(a,b){return this.fileTypeConfig=b.fileTypeConfig,a}},{key:"parse",value:function(a,b){var c=b.match,d=b.getValue;return c(this.prefix,a)?{type:"placeholder",value:d(this.prefix,a),module:h}:null}},{key:"postparse",value:function(a){return e.expandToOne(a,{moduleName:h,getInner:j,expandTo:this.fileTypeConfig.tagRawXml,error:{message:"Raw tag not in paragraph",id:"raw_tag_outerxml_invalid",explanation:function(a){return'The tag "'.concat(a.value,'" is not inside a paragraph, putting raw tags inside an inline loop is disallowed.')}}})}},{key:"render",value:function(b,c){if(b.module!==h)return null;var a,d=[];try{a=c.scopeManager.getValue(b.value,{part:b}),null==a&&(a=c.nullGetter(b))}catch(e){return d.push(e),{errors:d}}return a?{value:a}:{value:""}}},{key:"resolve",value:function(a,b){return"placeholder"!==a.type||a.module!==h?null:b.scopeManager.getValueAsync(a.value,{part:a}).then(function(c){return null==c?b.nullGetter(a):c})}}],d(a.prototype,b),c&&d(a,c),f}();b.exports=function(){return i(new k)}},{"../doc-utils":3,"../errors":4,"../module-wrapper":10,"../traits":23}],15:[function(a,c,d){"use strict";function e(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}var f=a("../module-wrapper"),g=a("../errors").getScopeCompilationError,b=a("../doc-utils"),h=b.utf8ToWord,i=b.hasCorruptCharacters,j=a("../errors").getCorruptCharactersException,k={docx:"w",pptx:"a"},l=function(){var a,b,c;function d(){!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,d),this.name="Render",this.recordRun=!1,this.recordedRun=[]}return a=d,b=[{key:"set",value:function(a){a.compiled&&(this.compiled=a.compiled),null!=a.data&&(this.data=a.data)}},{key:"getRenderedMap",value:function(a){var b=this;return Object.keys(this.compiled).reduce(function(a,c){return a[c]={from:c,data:b.data},a},a)}},{key:"optionsTransformer",value:function(b,a){return this.parser=a.parser,this.fileType=a.fileType,b}},{key:"postparse",value:function(a,c){var d=this,b=[];return a.forEach(function(a){if("placeholder"===a.type){var e=a.value;try{c.cachedParsers[a.lIndex]=d.parser(e,{tag:a})}catch(f){b.push(g({tag:e,rootError:f,offset:a.offset}))}}}),{postparsed:a,errors:b}}},{key:"recordRuns",value:function(a){a.tag==="".concat(k[this.fileType],":r")?(this.recordRun=!1,this.recordedRun=[]):a.tag==="".concat(k[this.fileType],":rPr")?("start"===a.position&&(this.recordRun=!0,this.recordedRun=[a.value]),"end"===a.position&&(this.recordedRun.push(a.value),this.recordRun=!1)):this.recordRun&&this.recordedRun.push(a.value)}},{key:"render",value:function(b,c){var a,e=c.scopeManager,d=c.linebreaks,f=c.nullGetter;if(d&&this.recordRuns(b),"placeholder"===b.type&&!b.module){try{a=e.getValue(b.value,{part:b})}catch(g){return{errors:[g]}}return(null==a&&(a=f(b)),i(a))?{errors:[j({tag:b.value,value:a,offset:b.offset})]}:("string"!=typeof a&&(a=a.toString()),d)?this.renderLineBreaks(a):{value:h(a)}}}},{key:"renderLineBreaks",value:function(b){var a=k[this.fileType],c="docx"===this.fileType?"<w:r><w:br/></w:r>":"<a:br/>",d=b.split("\n"),e=this.recordedRun.join("");return{value:d.map(function(a){return h(a)}).join("</".concat(a,":t></").concat(a,":r>").concat(c,"<").concat(a,":r>").concat(e,"<").concat(a,":t").concat("docx"===this.fileType?' xml:space="preserve"':"",">"))}}}],e(a.prototype,b),c&&e(a,c),d}();c.exports=function(){return f(new l)}},{"../doc-utils":3,"../errors":4,"../module-wrapper":10}],16:[function(b,c,f){"use strict";var g=b("../module-wrapper"),a=b("../doc-utils"),h=a.isTextStart,i=a.isTextEnd,j=a.endsWith,k=a.startsWith,d='<w:t xml:space="preserve">',l=d.length,e="</w:t>",m=e.length;function n(b,c){var a=b[c].value;return"</w:t>"===b[c+1].value|| -1!==a.indexOf('xml:space="preserve"')?a:a.substr(0,a.length-1)+' xml:space="preserve">'}var o={name:"SpacePreserveModule",postparse:function(b,d){var c=[],e=!1,f=0,g=0,a=b.reduce(function(b,a){var l,k,m,j,o;return(h(l=a)&&"w:t"===l.tag&&(e=!0,g=c.length),e)?(c.push(a),k=d,m=c,k&&k.basePart&&m.length>1&&(f=d.basePart.endLindex,c[0].value=n(c,0)),j=a,o=c,"placeholder"===j.type&&(!j.module||"loop"===j.module)&&o.length>1&&(c[g].value=n(c,g),f=a.endLindex),i(a)&&a.lIndex>f&&(0!==f&&(c[g].value=n(c,g)),Array.prototype.push.apply(b,c),c=[],e=!1,f=0,g=0),b):(b.push(a),b)},[]);return Array.prototype.push.apply(a,c),a},postrender:function(a){var b="",c=0;return a.reduce(function(f,a,g){return""===a?(f.push(a),f):(-1!==a.indexOf('<w:t xml:space="preserve"></w:t>')&&(a=a.replace(/<w:t xml:space="preserve"><\/w:t>/g,"<w:t/>")),j(b,d)&&k(a,e)&&(f[c]=b.substr(0,b.length-l)+"<w:t/>",a=a.substr(m)),b=a,c=g,f.push(a),f)},[])}};c.exports=function(){return g(o)}},{"../doc-utils":3,"../module-wrapper":10}],17:[function(b,d,e){"use strict";function f(c,d){var a=Object.keys(c);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(c);d&&(b=b.filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable})),a.push.apply(a,b)}return a}function g(c){for(var a=1;a<arguments.length;a++){var b=null!=arguments[a]?arguments[a]:{};a%2?f(Object(b),!0).forEach(function(a){h(c,a,b[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(b)):f(Object(b)).forEach(function(a){Object.defineProperty(c,a,Object.getOwnPropertyDescriptor(b,a))})}return c}function h(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var c=b("./doc-utils"),i=c.wordToUtf8,j=c.concatArrays,a=b("./prefix-matcher"),k=a.match,l=a.getValue,m=a.getValues;d.exports={preparse:function(a,b,c){var d,e;return{preparsed:(d=a,e=c,b.forEach(function(a){a.preparse(d,e)}))}},postparse:function(a,e,b){function f(a,b){return e.map(function(c){return c.getTraits(a,b)})}var c=[];function d(a,b){return e.reduce(function(e,h){var a=h.postparse(e,g(g({},b),{},{postparse:function(a,c){return d(a,g(g({},b),c))},getTraits:f}));return null==a?e:a.errors?(c=j([c,a.errors]),a.postparsed):a},a)}return{postparsed:d(a,b),errors:c}},parse:function(a,b,c){var d,e=!1,f="",h=[];return a.reduce(function(j,a){return"delimiter"===a.type?(e="start"===a.position,"end"===a.position&&(f=i(f),c.parse=function(e){return function(d,a){var b,g=a.modules,e=a.startOffset,c=a.lIndex;a.offset=e,a.lIndex=c,a.match=k,a.getValue=l,a.getValues=m;for(var f=0,h=g.length;f<h;f++)if(b=g[f].parse(d,a))return b.offset=e,b.endLindex=c,b.lIndex=c,b.raw=d,b;return{type:"placeholder",value:d,offset:e,endLindex:c,lIndex:c}}(e,g(g(g({},c),a),{},{startOffset:d,modules:b}))},j.push(c.parse(f)),Array.prototype.push.apply(j,h),h=[]),"start"===a.position&&(h=[],d=a.offset),f="",j):e?"content"!==a.type||"insidetag"!==a.position?(h.push(a),j):(f+=a.value,j):(j.push(a),j)},[])}}},{"./doc-utils":3,"./prefix-matcher":19}],18:[function(b,a,c){"use strict";a.exports=function(b,a){for(var c=0,d=a.modules.length;c<d;c++)b=a.modules[c].postrender(b,a);return a.joinUncorrupt(b,a)}},{}],19:[function(b,a,c){"use strict";a.exports={match:function(a,b){return"string"==typeof a?b.substr(0,a.length)===a:a instanceof RegExp?a.test(b):void 0},getValue:function(a,b){return"string"==typeof a?b.substr(a.length):a instanceof RegExp?b.match(a)[1]:void 0},getValues:function(a,b){if(a instanceof RegExp)return b.match(a)}}},{}],20:[function(a,b,c){"use strict";var d=a("./doc-utils").concatArrays,e=a("./errors").throwUnimplementedTagType;b.exports=function(a){var g=a.baseNullGetter,b=a.compiled,h=a.scopeManager;a.nullGetter=function(a,b){return g(a,b||h)},a.prefix||(a.prefix=""),a.index&&(a.prefix=a.prefix+a.index+"-");var c=[],f=b.map(function(b,g){a.index=g;var f=function(d,a){for(var c,b=0,e=a.modules.length;b<e;b++)if(c=a.modules[b].render(d,a))return c;return!1}(b,a);return f?(f.errors&&(c=d([c,f.errors])),f.value):"content"===b.type||"tag"===b.type?b.value:void e(b,g)});return{errors:c,parts:f}}},{"./doc-utils":3,"./errors":4}],21:[function(b,a,c){"use strict";function d(c,a){(null==a||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}a.exports=function(a){var b=[],e=a.baseNullGetter,c=a.compiled,f=a.scopeManager;a.nullGetter=function(a,b){return e(a,b||f)},a.resolved=b;var g=[];return Promise.all(c.filter(function(a){return -1===["content","tag"].indexOf(a.type)}).reduce(function(h,c){var e,i=function(d,a){for(var c,b=0,e=a.modules.length;b<e;b++)if(c=a.modules[b].resolve(d,a))return c;return!1}(c,a);if(i)e=i.then(function(a){b.push({tag:c.value,value:a,lIndex:c.lIndex})});else{if("placeholder"!==c.type)return;e=f.getValueAsync(c.value,{part:c}).then(function(d){return null==d&&(d=a.nullGetter(c)),b.push({tag:c.value,value:d,lIndex:c.lIndex}),d})}return h.push(e.catch(function(a){if(a.length>1){var b;g.push.apply(g,function(a){if(Array.isArray(a))return d(a)}(b=a)||function(a){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a))return Array.from(a)}(b)||function(a,c){if(a){if("string"==typeof a)return d(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if("Object"===b&&a.constructor&&(b=a.constructor.name),"Map"===b||"Set"===b)return Array.from(a);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return d(a,c)}}(b)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}else g.push(a)})),h},[])).then(function(){return{errors:g,resolved:b}})}},{}],22:[function(a,b,c){"use strict";function d(c,a){(null==a||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function e(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}var f=a("./errors").getScopeParserExecutionError,g=a("./utils").last,h=a("./doc-utils").concatArrays;function i(b,d){for(var c,e=b.length>>>0,a=0;a<e;a++)if(c=b[a],d.call(this,c,a,b))return c}function j(c,a,b){var d,e,l=this,g=this.scopeList[b];if(this.root.finishedResolving){var h=this.resolved;return this.scopePath.forEach(function(b,a){var c=l.scopeLindex[a];h=(h=i(h,function(a){return a.lIndex===c})).value[l.scopePathItem[a]]}),[this.scopePath.length-1,i(h,function(b){return a.part.lIndex===b.lIndex}).value]}e=this.cachedParsers&&a.part?this.cachedParsers[a.part.lIndex]?this.cachedParsers[a.part.lIndex]:this.cachedParsers[a.part.lIndex]=this.parser(c,{scopePath:this.scopePath}):this.parser(c,{scopePath:this.scopePath});try{d=e.get(g,this.getContext(a,b))}catch(k){throw f({tag:c,scope:g,error:k,offset:a.part.offset})}return null==d&&b>0?j.call(this,c,a,b-1):[b,d]}function k(b,a,c){var d,e=this,g=this.scopeList[c];return d=this.cachedParsers&&a.part?this.cachedParsers[a.part.lIndex]?this.cachedParsers[a.part.lIndex]:this.cachedParsers[a.part.lIndex]=this.parser(b,{scopePath:this.scopePath}):this.parser(b,{scopePath:this.scopePath}),Promise.resolve().then(function(){return d.get(g,e.getContext(a,c))}).catch(function(c){throw f({tag:b,scope:g,error:c,offset:a.part.offset})}).then(function(d){return null==d&&c>0?k.call(e,b,a,c-1):d})}var l=function(){var a,b,c;function f(a){!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,f),this.root=a.root||this,this.scopePath=a.scopePath,this.scopePathItem=a.scopePathItem,this.scopePathLength=a.scopePathLength,this.scopeList=a.scopeList,this.scopeLindex=a.scopeLindex,this.parser=a.parser,this.resolved=a.resolved,this.cachedParsers=a.cachedParsers}return a=f,b=[{key:"loopOver",value:function(a,b,c,d){return this.loopOverValue(this.getValue(a,d),b,c)}},{key:"functorIfInverted",value:function(a,b,c,d,e){return a&&b(c,d,e),a}},{key:"isValueFalsy",value:function(a,b){return null==a||!a||"[object Array]"===b&&0===a.length}},{key:"loopOverValue",value:function(a,c,b){this.root.finishedResolving&&(b=!1);var e=Object.prototype.toString.call(a);if(this.isValueFalsy(a,e))return this.functorIfInverted(b,c,g(this.scopeList),0,1);if("[object Array]"===e){for(var d=0;d<a.length;d++)this.functorIfInverted(!b,c,a[d],d,a.length);return!0}return"[object Object]"===e?this.functorIfInverted(!b,c,a,0,1):this.functorIfInverted(!b,c,g(this.scopeList),0,1)}},{key:"getValue",value:function(e,f){var a,b,c=(a=j.call(this,e,f,this.scopeList.length-1),b=2,function(a){if(Array.isArray(a))return a}(a)||function(d,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(d)){var a=[],b=!0,f=!1,g=void 0;try{for(var h,c=d[Symbol.iterator]();!(b=(h=c.next()).done)&&(a.push(h.value),!e||a.length!==e);b=!0);}catch(i){f=!0,g=i}finally{try{b||null==c.return||c.return()}finally{if(f)throw g}}return a}}(a,b)||function(a,c){if(a){if("string"==typeof a)return d(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if("Object"===b&&a.constructor&&(b=a.constructor.name),"Map"===b||"Set"===b)return Array.from(a);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return d(a,c)}}(a,b)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),g=c[0],h=c[1];return this.num=g,h}},{key:"getValueAsync",value:function(a,b){return k.call(this,a,b,this.scopeList.length-1)}},{key:"getContext",value:function(a,b){return{num:b,meta:a,scopeList:this.scopeList,resolved:this.resolved,scopePath:this.scopePath,scopePathItem:this.scopePathItem,scopePathLength:this.scopePathLength}}},{key:"createSubScopeManager",value:function(a,b,c,d,e){return new f({root:this.root,resolved:this.resolved,parser:this.parser,cachedParsers:this.cachedParsers,scopeList:h([this.scopeList,[a]]),scopePath:h([this.scopePath,[b]]),scopePathItem:h([this.scopePathItem,[c]]),scopePathLength:h([this.scopePathLength,[e]]),scopeLindex:h([this.scopeLindex,[d.lIndex]])})}}],e(a.prototype,b),c&&e(a,c),f}();b.exports=function(a){return a.scopePath=[],a.scopePathItem=[],a.scopePathLength=[],a.scopeLindex=[],a.scopeList=[a.tags],new l(a)}},{"./doc-utils":3,"./errors":4,"./utils":24}],23:[function(c,d,e){"use strict";function f(a){return j(a)||i(a)||h(a)||g()}function g(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(a,c){if(a){if("string"==typeof a)return k(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if("Object"===b&&a.constructor&&(b=a.constructor.name),"Map"===b||"Set"===b)return Array.from(a);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return k(a,c)}}function i(a){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a))return Array.from(a)}function j(a){if(Array.isArray(a))return k(a)}function k(c,a){(null==a||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function l(c,d){var a=Object.keys(c);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(c);d&&(b=b.filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable})),a.push.apply(a,b)}return a}function m(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function n(a){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}var a=c("./doc-utils"),o=a.getRightOrNull,p=a.getRight,q=a.getLeft,r=a.getLeftOrNull,s=a.chunkBy,t=a.isTagStart,u=a.isTagEnd,v=a.isContent,w=a.last,x=a.first,b=c("./errors"),y=b.XTTemplateError,z=b.throwExpandNotFound,A=b.getLoopPositionProducesInvalidXMLError;function B(a,b){if(0===a.length)return!1;var c=w(a).tag.substr(1),d=b.substr(2,b.length-3);return 0===c.indexOf(d)}function C(a,b){return a.push({tag:b}),a}function D(h,b,a,d){var e,f,g=h.expandTo||d.expandTo;if(!g)return a;try{f=q(a,g,b),e=p(a,g,b)}catch(i){throw i instanceof y&&z(function(c){for(var a=1;a<arguments.length;a++){var b=null!=arguments[a]?arguments[a]:{};a%2?l(Object(b),!0).forEach(function(a){m(c,a,b[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(b)):l(Object(b)).forEach(function(a){Object.defineProperty(c,a,Object.getOwnPropertyDescriptor(b,a))})}return c}({part:h,rootError:i,postparsed:a,expandTo:g,index:b},d.error)),i}var j=a.slice(f,b),k=a.slice(b+1,e+1),c=d.getInner({postparse:d.postparse,index:b,part:h,leftParts:j,rightParts:k,left:f,right:e,postparsed:a});return c.length||(c.expanded=[j,k],c=[c]),{left:f,right:e,inner:c}}d.exports={expandToOne:function(a,l){var e=[];a.errors&&(e=a.errors,a=a.postparsed);for(var g=[],b=0,n=a.length;b<n;b++){var h=a[b];if("placeholder"===h.type&&h.module===l.moduleName)try{var m=D(h,b,a,l);b=m.right,g.push(m)}catch(i){if(i instanceof y)e.push(i);else throw i}}for(var d=[],j=0,c=0,o=a.length;c<o;c++){var p=a[c],k=g[j];k&&k.left===c?(d.push.apply(d,f(g[j].inner)),j++,c=k.right):d.push(p)}return{postparsed:d,errors:e}},getExpandToDefault:function(f,a,g){var d=function(e){for(var b,d=e.filter(function(a){return"tag"===a.type}),a=[],c=0;c<d.length;c++)"/"===(b=d[c].value)[1]?B(a,b)?a.pop():a=C(a,b):"/"!==b[b.length-2]&&(a=C(a,b));return a}(f.slice(a[0].offset,a[1].offset)),h=d.filter(function(a){return"/"===a.tag[1]}).length,i=d.filter(function(b){var a=b.tag;return"/"!==a[1]&&"/"!==a[a.length-2]}).length;if(h!==i)return{error:A({tag:x(a).part.value,offset:[x(a).part.offset,w(a).part.offset]})};for(var b=0,e=g.length;b<e;b++){var c=function(j,y){var b=g[j],c=b.contains,k=b.expand,l=b.onlyTextInTag;if(function(c,b){for(var a=0;a<b.length;a++)if(0===b[a].tag.indexOf("<".concat(c)))return!0;return!1}(c,d)){if(l){var h=r(f,c,a[0].offset),i=o(f,c,a[1].offset);if(null===h||null===i)return"continue";var e=s(f.slice(h,i),function(a){return t(c,a)?"start":u(c,a)?"end":null});if(e.length<=2)return"continue";var m=x(e),n=w(e),p=m.filter(v),q=n.filter(v);if(1!==p.length||1!==q.length)return"continue"}return{v:{value:k}}}}(b,e);if("continue"!==c&&"object"===n(c))return c.v}return!1}}},{"./doc-utils":3,"./errors":4}],24:[function(b,a,c){"use strict";a.exports={last:function(a){return a[a.length-1]},first:function(a){return a[0]}}},{}],25:[function(a,b,c){"use strict";var d=a("./doc-utils").pregMatchAll;b.exports=function(b,c){var a={};a.content=b,a.tagsXmlArray=c,a.tagsXmlArrayJoined=a.tagsXmlArray.join("|");var e=new RegExp("(?:(<(?:".concat(a.tagsXmlArrayJoined,")[^>]*>)([^<>]*)</(?:").concat(a.tagsXmlArrayJoined,")>)|(<(?:").concat(a.tagsXmlArrayJoined,")[^>]*/>)"),"g");return a.matches=d(e,a.content),function(a){function c(){var b={array:Array.prototype.slice.call(arguments)};b.array.shift();var c=b.array[0]+b.array[1];b.array.unshift(c),b.array.pop();var d=b.array.pop();b.offset=d,b.first=!0,a.matches.unshift(b)}-1===a.content.indexOf("<")&& -1===a.content.indexOf(">")&&a.content.replace(/^()([^<>]*)$/,c);var b=new RegExp("^()([^<]+)</(?:".concat(a.tagsXmlArrayJoined,")>"));return a.content.replace(b,c),b=new RegExp("(<(?:".concat(a.tagsXmlArrayJoined,")[^>]*>)([^>]+)$")),a.content.replace(b,function(){var b={array:Array.prototype.slice.call(arguments)};b.array.pop();var c=b.array.pop();b.offset=c,b.last=!0,-1===b.array[0].indexOf("/>")&&a.matches.push(b)}),a}(a)}},{"./doc-utils":3}],26:[function(a,c,d){"use strict";function e(a){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function f(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}var b=a("./doc-utils"),g=b.wordToUtf8,h=b.convertSpaces,i=b.defaults,j=a("./xml-matcher"),k=a("./errors").throwContentMustBeString,l=a("./lexer"),m=a("./parser.js"),n=a("./render.js"),o=a("./postrender.js"),p=a("./resolve.js"),q=a("./join-uncorrupt");c.exports=function(){var a,b,c;function d(b,a){!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,d),this.filePath=a.filePath,this.cachedParsers={},this.modules=a.modules,this.fileTypeConfig=a.fileTypeConfig,this.contentType=a.contentType,Object.keys(i).map(function(b){this[b]=null!=a[b]?a[b]:i[b]},this),this.setModules({inspect:{filePath:this.filePath}}),this.load(b)}return a=d,b=[{key:"load",value:function(a){"string"!=typeof a&&k(e(a)),this.content=a}},{key:"setTags",value:function(a){return this.tags=null!=a?a:{},this}},{key:"resolveTags",value:function(b){var c=this;this.tags=null!=b?b:{};var a=this.getOptions();return a.scopeManager=this.scopeManager,a.resolve=p,p(a).then(function(d){var e=d.resolved,b=d.errors;if(b.forEach(function(a){a.properties=a.properties||{},a.properties.file=c.filePath}),0!==b.length)throw b;return Promise.all(e).then(function(b){return a.scopeManager.finishedResolving=!0,a.scopeManager.resolved=b,c.setModules({inspect:{resolved:b}}),b})})}},{key:"getFullText",value:function(){var b,c,a;return a=j(b=this.content,this.fileTypeConfig.tagsXmlTextArray).matches.map(function(a){return a.array[2]}),g(h(a.join("")))}},{key:"setModules",value:function(a){this.modules.forEach(function(b){b.set(a)})}},{key:"preparse",value:function(){this.allErrors=[],this.xmllexed=l.xmlparse(this.content,{text:this.fileTypeConfig.tagsXmlTextArray,other:this.fileTypeConfig.tagsXmlLexedArray}),this.setModules({inspect:{xmllexed:this.xmllexed}});var a=l.parse(this.xmllexed,this.delimiters),b=a.lexed,c=a.errors;this.allErrors=this.allErrors.concat(c),this.lexed=b,this.setModules({inspect:{lexed:this.lexed}});var d=this.getOptions();m.preparse(this.lexed,this.modules,d)}},{key:"parse",value:function(){this.setModules({inspect:{filePath:this.filePath}});var a=this.getOptions();this.parsed=m.parse(this.lexed,this.modules,a),this.setModules({inspect:{parsed:this.parsed}});var b=m.postparse(this.parsed,this.modules,a),c=b.postparsed,d=b.errors;return this.postparsed=c,this.setModules({inspect:{postparsed:this.postparsed}}),this.allErrors=this.allErrors.concat(d),this.errorChecker(this.allErrors),this}},{key:"errorChecker",value:function(a){var b=this;a.length&&(a.forEach(function(a){a.properties=a.properties||{},a.properties.file=b.filePath}),this.modules.forEach(function(b){a=b.errorsTransformer(a)}))}},{key:"baseNullGetter",value:function(b,c){var d=this,a=this.modules.reduce(function(a,e){return null!=a?a:e.nullGetter(b,c,d)},null);return null!=a?a:this.nullGetter(b,c)}},{key:"getOptions",value:function(){return{compiled:this.postparsed,cachedParsers:this.cachedParsers,tags:this.tags,modules:this.modules,parser:this.parser,contentType:this.contentType,baseNullGetter:this.baseNullGetter.bind(this),filePath:this.filePath,fileTypeConfig:this.fileTypeConfig,linebreaks:this.linebreaks}}},{key:"render",value:function(d){this.filePath=d;var a=this.getOptions();a.resolved=this.scopeManager.resolved,a.scopeManager=this.scopeManager,a.render=n,a.joinUncorrupt=q;var c=n(a),b=c.errors,e=c.parts;return this.allErrors=b,this.errorChecker(b),b.length>0||(this.content=o(e,a),this.setModules({inspect:{content:this.content}})),this}}],f(a.prototype,b),c&&f(a,c),d}()},{"./doc-utils":3,"./errors":4,"./join-uncorrupt":7,"./lexer":8,"./parser.js":17,"./postrender.js":18,"./render.js":20,"./resolve.js":21,"./xml-matcher":25}],"/src/js/docxtemplater.js":[function(a,f,g){"use strict";function h(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}var b=a("./doc-utils");b.traits=a("./traits"),b.moduleWrapper=a("./module-wrapper");var i=a("./scope-manager"),e=a("./errors"),j=e.throwMultiError,k=e.throwResolveBeforeCompile,l=e.throwRenderInvalidTemplate,m=a("./collect-content-types"),n=a("./modules/common"),o=a("./lexer"),p=b.defaults,q=b.str2xml,r=b.xml2str,s=b.moduleWrapper,t=b.utf8ToWord,u=b.concatArrays,v=b.unique,d=a("./errors"),w=d.XTInternalError,x=d.throwFileTypeNotIdentified,y=d.throwFileTypeNotHandled,z=d.throwApiVersionError,A=[3,25,0],c=function(){var a,c,d;function e(a){var g=this,b=arguments.length>1&& void 0!==arguments[1]?arguments[1]:{},c=b.modules,d=void 0===c?[]:c,f=function(a,d){if(null==a)return{};var b,c,e=function(c,f){if(null==c)return{};var a,b,d={},e=Object.keys(c);for(b=0;b<e.length;b++)a=e[b],f.indexOf(a)>=0||(d[a]=c[a]);return d}(a,d);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(a);for(c=0;c<f.length;c++)b=f[c],!(d.indexOf(b)>=0)&&Object.prototype.propertyIsEnumerable.call(a,b)&&(e[b]=a[b])}return e}(b,["modules"]);if(!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,e),!Array.isArray(d))throw new Error("The modules argument of docxtemplater's constructor must be an array");if(this.scopeManagers={},this.compiled={},this.modules=[n()],this.setOptions(f),d.forEach(function(a){g.attachModule(a)}),arguments.length>0){if(!a||!a.files||"function"!=typeof a.file)throw new Error("The first argument of docxtemplater's constructor must be a valid zip file (jszip v2 or pizzip v3)");this.loadZip(a),this.modules=this.modules.filter(function(a){if(a.supportedFileTypes){if(!Array.isArray(a.supportedFileTypes))throw new Error("The supportedFileTypes field of the module must be an array");var b=-1!==a.supportedFileTypes.indexOf(g.fileType);return b||a.on("detached"),b}return!0}),this.compile(),this.v4Constructor=!0}}return a=e,c=[{key:"getModuleApiVersion",value:function(){return A.join(".")}},{key:"verifyApiVersion",value:function(a){return 3!==(a=a.split(".").map(function(a){return parseInt(a,10)})).length&&z("neededVersion is not a valid version",{neededVersion:a,explanation:"the neededVersion must be an array of length 3"}),a[0]!==A[0]&&z("The major api version do not match, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:a,currentModuleApiVersion:A,explanation:"moduleAPIVersionMismatch : needed=".concat(a.join("."),", current=").concat(A.join("."))}),a[1]>A[1]&&z("The minor api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:a,currentModuleApiVersion:A,explanation:"moduleAPIVersionMismatch : needed=".concat(a.join("."),", current=").concat(A.join("."))}),a[1]===A[1]&&a[2]>A[2]&&z("The patch api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:a,currentModuleApiVersion:A,explanation:"moduleAPIVersionMismatch : needed=".concat(a.join("."),", current=").concat(A.join("."))}),!0}},{key:"setModules",value:function(a){this.modules.forEach(function(b){b.set(a)})}},{key:"sendEvent",value:function(a){this.modules.forEach(function(b){b.on(a)})}},{key:"attachModule",value:function(a){var d=arguments.length>1&& void 0!==arguments[1]?arguments[1]:{};if(this.v4Constructor)throw new Error("attachModule() should not be called manually when using the v4 constructor");if(a.requiredAPIVersion&&this.verifyApiVersion(a.requiredAPIVersion),!0===a.attached)throw new Error('Cannot attach a module that was already attached : "'.concat(a.name,'". Maybe you are instantiating the module at the root level, and using it for multiple instances of Docxtemplater'));a.attached=!0;var b=d.prefix;b&&(a.prefix=b);var c=s(a);return this.modules.push(c),c.on("attached"),this}},{key:"setOptions",value:function(a){var b=this;if(this.v4Constructor)throw new Error("setOptions() should not be called manually when using the v4 constructor");if(!a)throw new Error("setOptions should be called with an object as first parameter");return a.delimiters&&(a.delimiters.start=t(a.delimiters.start),a.delimiters.end=t(a.delimiters.end)),this.options={},Object.keys(p).forEach(function(c){var d=p[c];b.options[c]=null!=a[c]?a[c]:d,b[c]=b.options[c]}),this.zip&&this.updateFileTypeConfig(),this}},{key:"loadZip",value:function(a){if(a.loadAsync)throw new w("Docxtemplater doesn't handle JSZip version >=3, please use pizzip");return this.zip=a,this.updateFileTypeConfig(),this.modules=u([this.fileTypeConfig.baseModules.map(function(a){return a()}),this.modules]),this}},{key:"compileFile",value:function(a){this.compiled[a].parse()}},{key:"precompileFile",value:function(a){var b=this.createTemplateClass(a);b.preparse(),this.compiled[a]=b}},{key:"getScopeManager",value:function(a,b,c){return this.scopeManagers[a]||(this.scopeManagers[a]=i({tags:c||{},parser:this.parser,cachedParsers:b.cachedParsers})),this.scopeManagers[a]}},{key:"resolveData",value:function(a){var b=this,c=[];return Object.keys(this.compiled).length||k(),Promise.resolve(a).then(function(a){return b.setData(a),b.setModules({data:b.data,Lexer:o}),b.mapper=b.modules.reduce(function(a,b){return b.getRenderedMap(a)},{}),Promise.all(Object.keys(b.mapper).map(function(d){var a=b.mapper[d],f=a.from,e=a.data;return Promise.resolve(e).then(function(e){var a=b.compiled[f];return a.filePath=d,a.scopeManager=b.getScopeManager(d,a,e),a.scopeManager.resolved=[],a.resolveTags(e).then(function(b){return a.scopeManager.finishedResolving=!0,b},function(a){c=c.concat(a)})})})).then(function(a){return 0!==c.length&&j(c),u(a)})})}},{key:"compile",value:function(){var a=this;return Object.keys(this.compiled).length||(this.options=this.modules.reduce(function(b,c){return c.optionsTransformer(b,a)},this.options),this.options.xmlFileNames=v(this.options.xmlFileNames),this.xmlDocuments=this.options.xmlFileNames.reduce(function(b,c){var d=a.zip.files[c].asText();return b[c]=q(d),b},{}),this.setModules({zip:this.zip,xmlDocuments:this.xmlDocuments}),this.getTemplatedFiles(),this.setModules({compiled:this.compiled}),this.templatedFiles.forEach(function(b){null!=a.zip.files[b]&&a.precompileFile(b)}),this.templatedFiles.forEach(function(b){null!=a.zip.files[b]&&a.compileFile(b)}),B(this)),this}},{key:"updateFileTypeConfig",value:function(){var a,h=this;this.zip.files.mimetype&&(a="odt");var d=this.zip.files["[Content_Types].xml"];this.targets=[];var c=d?q(d.asText()):null,f=c?c.getElementsByTagName("Override"):null,g=c?c.getElementsByTagName("Default"):null;return c&&(this.filesContentTypes=m(f,g,this.zip),this.invertedContentTypes=b.invertMap(this.filesContentTypes),this.setModules({contentTypes:this.contentTypes,invertedContentTypes:this.invertedContentTypes})),this.modules.forEach(function(b){a=b.getFileType({zip:h.zip,contentTypes:d,contentTypeXml:c,overrides:f,defaults:g,doc:h})||a}),"odt"===a&&y(a),a||x(),this.fileType=a,this.fileTypeConfig=this.options.fileTypeConfig||this.fileTypeConfig||e.FileTypeConfig[this.fileType](),this}},{key:"render",value:function(){var a=this;return this.compile(),this.errors.length>0&&l(),this.setModules({data:this.data,Lexer:o}),this.mapper=this.modules.reduce(function(a,b){return b.getRenderedMap(a)},{}),this.fileTypeConfig.tagsXmlLexedArray=v(this.fileTypeConfig.tagsXmlLexedArray),this.fileTypeConfig.tagsXmlTextArray=v(this.fileTypeConfig.tagsXmlTextArray),Object.keys(this.mapper).forEach(function(c){var d=a.mapper[c],f=d.from,e=d.data,b=a.compiled[f];b.setTags(e),b.scopeManager=a.getScopeManager(c,b,e),b.render(c),a.zip.file(c,b.content,{createFolders:!0})}),B(this),this.sendEvent("syncing-zip"),this.syncZip(),this}},{key:"syncZip",value:function(){var a=this;Object.keys(this.xmlDocuments).forEach(function(b){a.zip.remove(b);var c=r(a.xmlDocuments[b]);return a.zip.file(b,c,{createFolders:!0})})}},{key:"setData",value:function(a){return this.data=a,this}},{key:"getZip",value:function(){return this.zip}},{key:"createTemplateClass",value:function(a){var b=this.zip.files[a].asText();return this.createTemplateClassFromContent(b,a)}},{key:"createTemplateClassFromContent",value:function(b,a){var d=this,c={filePath:a,contentType:this.filesContentTypes[a]};return Object.keys(p).concat(["filesContentTypes","fileTypeConfig","modules"]).forEach(function(a){c[a]=d[a]}),new e.XmlTemplater(b,c)}},{key:"getFullText",value:function(a){return this.createTemplateClass(a||this.fileTypeConfig.textPath(this)).getFullText()}},{key:"getTemplatedFiles",value:function(){var a=this;return this.templatedFiles=this.fileTypeConfig.getTemplatedFiles(this.zip),this.targets.forEach(function(b){a.templatedFiles.push(b)}),this.templatedFiles}}],h(a.prototype,c),d&&h(a,d),e}();function B(b){var c=b.compiled,a=[];Object.keys(c).forEach(function(b){a=u([a,c[b].allErrors])}),b.errors=a,0!==a.length&&j(a)}c.DocUtils=b,c.Errors=a("./errors"),c.XmlTemplater=a("./xml-templater"),c.FileTypeConfig=a("./file-type-config"),c.XmlMatcher=a("./xml-matcher"),f.exports=c,window.docxtemplater=c},{"./collect-content-types":2,"./doc-utils":3,"./errors":4,"./file-type-config":5,"./lexer":8,"./module-wrapper":10,"./modules/common":11,"./scope-manager":22,"./traits":23,"./xml-matcher":25,"./xml-templater":26}]},{},[])("/src/js/docxtemplater.js")})